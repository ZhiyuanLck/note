# 内联

内联是一种将函数体直接展开到调用处的一种优化技术。

## 动机

考虑程序调用函数的过程：

- 把所有或一部分参数压入栈中，如果有其他参数没有入栈，通过某些特定的寄存器传递
- 把当前指令的下一条指令的地址压入栈中
- 跳转到函数体执行
- 将`rbp`压入栈中，这是为了函数返回时便于恢复以前的`rbp`的值；同时使`rbq`指向栈顶
- 可能在栈上分配一定的空间和保存一些寄存器
- 执行其他指令
- 恢复保存过的寄存器
- 恢复`rsp`并回收局部变量的值
- 从栈中取得返回地址，并跳转到该位置

## 参考链接

- [内联wiki](https://en.wikipedia.org/wiki/Inline_expansion)
- [内联优缺点](https://www.geeksforgeeks.org/inline-functions-cpp)
