# 存储转发传输

交换机在能够向输出链路传输分组的第一个比特之前，必须接收到整个分组。

## 简介

存储转发最早源自延迟容忍网络(DTN, delay-tolerant networking)，该网络体系结构旨在解决可能缺乏连续网络连接的异质网络中的技术问题。

## 应用场景

- 间歇性连接的网络（无线网，或者需要高可移动性的网络）
- 传输时间长，高错误率
- 没有直接的端到端连接

## 端对端时延

考虑P个分组大小分别为L1, L2, ..., L[P]比特

经过N条的链路(N - 1台交换机)传输，每条链路的传输速率为R1, R2, ..., R[N]比特/秒

对于第1台交换机，每个时刻不同的状态为

- 0时刻，第1台交换机开始接收第1个分组
- L1/R1 时刻，第1台交换机接收完开始转发第1个分组，开始接收第2个分组
- L1/R1 + L2/R1 时刻，第1台交换机接收完开始转发第2个分组，开始接收第3个分组
- ...
- L1/R1 + L2/R1 + ... + L[P]/R1 时刻，第1台交换机接收开始转发第P个分组

考虑第i个分组

- T[i] = L1/R1 + L2/R1 + ... + L[i]/R1时刻，第1台交换机开始转发第i个分组
- T[i] + L[i]/R2 时刻，第2台交换机开始转发第i个分组
- ...
- T[i] + L[i]/R2 + ... + L[i]/R[N-1] 时刻，第N - 1台交换机开始转发第i个分组

即传输完第i个分组所用时间为

L1/R1 + L2/R1 + ... + L[i]/R1 + L[i]/R2 + ... + L[i]/R[N]

传输P个分组的端对端时延为

L1/R1 + L2/R1 + ... + L[P]/R1 + L[P]/R2 + ... + L[P]/R[N]
